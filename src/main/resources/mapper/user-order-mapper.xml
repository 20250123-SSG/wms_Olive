<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.minisec.user.model.dao.order.OrderDao">

    <resultMap id="orderResultMap" type="OrderDto">
        <id column="user_id" property="userId"/>
        <result column="user_order_status" property="orderStatus"/>
        <result column="user_order_memo" property="orderMemo"/>
        <result column="created_at" property="orderDate"/>

        <association property="store" javaType="StoreDto">
            <id column="store_id" property="storeId"/>
        </association>
    </resultMap>

    <resultMap id="orderIdResultMap" type="OrderDto">
        <id column="user_order_id" property="orderId"/>
    </resultMap>

    <insert id="insertOrder" parameterType="OrderDto"
            useGeneratedKeys="true" keyProperty="orderId">
        INSERT INTO
            user_order
            (
              store_id
            , user_id
            , user_order_status
            , user_order_memo
            , created_at
            , modified_at
            )
        VALUES
            (
              #{store.storeId}
            , #{userId}
            , #{orderStatus}
            , #{orderMemo}
            , NOW()
            , NOW()
            )
    </insert>


    <select id="selectOrderListByUserId" parameterType="_int" resultMap="orderIdResultMap">
        SELECT
        user_order_id
        FROM
            user_order
        WHERE
        user_id = #{user_id}
    </select>


</mapper>